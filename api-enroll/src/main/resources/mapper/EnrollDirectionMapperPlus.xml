<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.javatribe.apienroll.mapper.EnrollDirectionMapperPlus">
  <resultMap id="BaseResultMap" type="com.javatribe.apienroll.entity.EnrollDirection">
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="direction_img" jdbcType="VARCHAR" property="directionImg" />
    <result column="direction_name" jdbcType="VARCHAR" property="directionName" />
    <result column="direction_code" jdbcType="INTEGER" property="directionCode" />
    <result column="gmt_created" jdbcType="TIMESTAMP" property="gmtCreated" />
    <result column="gmt_modified" jdbcType="TIMESTAMP" property="gmtModified" />
    <result column="delete_mark" jdbcType="INTEGER" property="deleteMark" />
  </resultMap>
  <sql id="Base_Column_List">
    id, direction_img, direction_name, direction_code, gmt_created, gmt_modified, delete_mark
  </sql>
  <select id="getLastNItemsOnPerDirection" resultType="com.javatribe.apienroll.entity.EnrollDirection">

    SELECT
    *
    FROM
    enroll_direction
    WHERE
    (
    SELECT
    COUNT(*) FROM enroll_direction AS e
    WHERE
    e.`direction_code` = enroll_direction.direction_code AND e.gmt_created >= enroll_direction.gmt_created
    )
    &lt;=
    <if test="n >= 0">
      #{n}
    </if>

  </select>
</mapper>