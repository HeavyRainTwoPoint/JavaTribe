(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5613308a"],{"04c1":function(t,a,e){},ce94:function(t,a,e){"use strict";e("04c1")},df89:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.editor?t._e():e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"title"},[t._v("方向选择")])]),t._l(t.directions,(function(a){return e("div",{key:a.tagId,staticClass:"box"},[e("div",{staticClass:"direction",class:{active:t.tagId==a.tagId},on:{click:function(e){return t.getExploreData(a)}}},[t._v(" "+t._s(a.tagName)+" ")])])}))],2),t.editor?t._e():e("div",{staticClass:"bottom"},[e("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box-card left",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"title"},[t._v("技术分类")])]),t._l(t.tagList,(function(a){return e("el-collapse",{key:a.tagId,attrs:{accordion:""},on:{change:function(e){return t.getTagData(a)}},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-collapse-item",{attrs:{title:a.tagName,name:a.tagId.toString()}})],1)}))],2),e("el-card",{staticClass:"box-card right",attrs:{border:""}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"title"},[t._v("数据列表")]),e("el-button",{staticClass:"button",on:{click:t.goMavon}},[t._v("+")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","max-height":"450",highlightCurrentRow:!0,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e("el-table-column",{attrs:{prop:"artTitle",label:"文章标题",align:"center"}}),e("el-table-column",{attrs:{prop:"artSummary",label:"文章摘要",align:"center"}}),e("el-table-column",{attrs:{prop:"artViewcount",label:"文章阅读数",align:"center"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return t.tableData.length>0?[e("el-button",{staticClass:"grey",attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(e){return t.handleEdit(a.$index,a.row)}}},[t._v(" 编辑 ")]),e("el-button",{staticClass:"grey",attrs:{type:"text",icon:"el-icon-delete-solid"},on:{click:function(e){return t.handleDelete(a.$index,a.row)}}},[t._v(" 删除 ")])]:void 0}}],null,!0)})],1)],1)],1),t.editor?t._e():e("el-pagination",{staticClass:"page",attrs:{bsckground:"","current-page":t.query.pageIndex,"page-sizes":[10,30,50,100],"page-size":t.query.pageSize,layout:"total,sizes, prev, pager, next, jumper",total:t.query.pageTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t.editor?e("div",{staticClass:"container"},[e("mavon-editor",{ref:"md",staticStyle:{"min-height":"600px"},on:{imgAdd:t.$imgAdd,change:t.change},model:{value:t.content,callback:function(a){t.content=a},expression:"content"}}),e("el-button",{staticClass:"editor-btn",attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")]),e("el-button",{staticClass:"editor-btn",attrs:{type:"primary"},on:{click:function(a){t.editor=!1}}},[t._v("返回")]),e("el-dialog",{attrs:{title:"修改文章",visible:t.dialogChangeVisible},on:{"update:visible":function(a){t.dialogChangeVisible=a}}},[e("el-form",{attrs:{"label-width":"80px",model:t.updateForm}},[e("el-form-item",{attrs:{label:"文章标题"}},[e("el-input",{model:{value:t.updateForm.artTitle,callback:function(a){t.$set(t.updateForm,"artTitle",a)},expression:"updateForm.artTitle"}})],1),e("el-form-item",{attrs:{label:"文章摘要"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.updateForm.artSummary,callback:function(a){t.$set(t.updateForm,"artSummary",a)},expression:"updateForm.artSummary"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.dialogChangeVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.articleEditor}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"添加文章",visible:t.dialogAddVisible},on:{"update:visible":function(a){t.dialogAddVisible=a}}},[e("el-form",{attrs:{"label-width":"80px",model:t.addForm}},[e("el-form-item",{attrs:{label:"文章标题"}},[e("el-input",{model:{value:t.addForm.artTitle,callback:function(a){t.$set(t.addForm,"artTitle",a)},expression:"addForm.artTitle"}})],1),e("el-form-item",{attrs:{label:"文章摘要"}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.addForm.artSummary,callback:function(a){t.$set(t.addForm,"artSummary",a)},expression:"addForm.artSummary"}})],1),e("el-form-item",{attrs:{label:"方向选择"}},[e("el-select",{attrs:{"allow-create":"",placeholder:"请选择文章方向"},on:{change:t.changeDirection},model:{value:t.tagParent,callback:function(a){t.tagParent=a},expression:"tagParent"}},t._l(t.directions,(function(t){return e("el-option",{key:t.tagId,attrs:{label:t.tagName,value:t.tagId}})})),1)],1),e("el-form-item",{attrs:{label:"标签选择"}},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"如果没有你需要的标签，可以点击自己输入",placement:"top-start"}},[e("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择文章标签"},on:{change:t.changeTag},model:{value:t.tagForm,callback:function(a){t.tagForm=a},expression:"tagForm"}},t._l(t.tagList,(function(t){return e("el-option",{key:t.tagId,attrs:{label:t.tagName,value:t.tagId}})})),1)],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.dialogAddVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.articleAdd}},[t._v("确 定")])],1)],1)],1):t._e()],1)},n=[],s=(e("d3b7"),e("a434"),e("b2d8")),l=(e("64e1"),{name:"Article",data:function(){return{tableData:[],directions:[],tagList:[],loading:!1,activeName:"1",addData:!1,editor:!1,addForm:{},updateForm:{},tagForm:[],tags:[],dialogAddVisible:!1,dialogChangeVisible:!1,tagId:-1,tagParent:1,flag:"add",artNo:-1,query:{pageIndex:0,pageSize:10,pageTotal:10},content:"",html:"",img_url:"",tagName:""}},components:{mavonEditor:s["mavonEditor"]},created:function(){this.getData(),this.getList(),this.getTagList()},methods:{getData:function(){var t=this;this.loading=!0,this.$http.get("/share/visit/getAllParentTags").then((function(a){200==a.code&&(t.directions=a.data)})).catch((function(a){t.$message.error("网络异常，请稍后重试")})).finally((function(){t.loading=!1}))},getList:function(){var t=this;this.tableData=[],this.loading=!0,this.$http.get("/share/visit/index",{curPage:this.query.pageIndex,size:this.query.pageSize}).then((function(a){200==a.code&&(a=a.data,t.tableData=a.list,t.query.pageTotal=a.total)})).finally((function(){t.loading=!1}))},getTagList:function(){var t=this;this.loading=!0,this.tagList=[],this.$http.get("/share/visit/getSonTagByParent",{tagParent:this.tagId}).then((function(a){200==a.code&&(t.tagList=a.data)})).finally((function(){t.loading=!1}))},getExploreData:function(t){var a=this;this.tagParent=t.tagParent,this.tagId=t.tagId,this.loading=!0,this.$http.get("/share/visit/index/explore",{tagId:this.tagId,curPage:this.query.pageIndex,size:this.query.pageSize}).then((function(t){t=t.data,a.tableData=t.list,a.query.pageTotal=t.total,a.getTagList()})).finally((function(){a.loading=!1}))},getTagData:function(t){var a=this;this.tagParent=t.tagParent,this.tagId=t.tagId,this.loading=!0,this.tableData=[],this.$http.get("/share/visit/index/explore",{tagId:this.tagId,curPage:this.query.pageIndex,size:this.query.pageSize}).then((function(t){t=t.data,a.tableData=t.list,a.query.pageTotal=t.total})).finally((function(){a.loading=!1}))},handleDelete:function(t,a){var e=this;this.$confirm("确定删除这一个文章吗？","提示",{type:"warning"}).then((function(){e.$http.post("/share/admin/delete",{artNo:a.artNo}).then((function(a){200==a.code&&(e.tableData.splice(t,1),e.$message({message:"删除成功",type:"success"}))}))})).catch((function(){}))},handleEdit:function(t,a){var e=this;this.$confirm("需要修改这篇文章吗？","提示",{type:"success"}).then((function(){e.getArticleDetails(a.artNo),e.editor=!0,e.updateForm=JSON.parse(JSON.stringify(a)),e.flag="editor",e.artNo=a.artNo})).catch((function(){}))},getArticleDetails:function(t){var a=this;this.$http.get("/share/visit/detail",{artNo:t}).then((function(t){200==t.code&&(a.content=t.data.article.artContent)}))},goMavon:function(){var t=this;this.$confirm("想要再写一篇文章吗？","提示",{type:"success"}).then((function(){t.editor=!0,t.flag="add"})).catch((function(){}))},$imgAdd:function(t,a){var e=this,i=new FormData;i.append("image",a),this.$http.upload("/share/admin/upload",i).then((function(a){200==a.code&&e.$refs.md.$img2Url(t,a.message)}))},change:function(t,a){this.html=a},submit:function(){0==this.content.length?this.$message({message:"请先输入一些文章内容",type:"warning"}):"add"==this.flag?this.dialogAddVisible=!0:"editor"==this.flag&&(this.dialogChangeVisible=!0)},changeDirection:function(t){this.tagId=t,this.tagForm=[],this.getTagList()},changeTag:function(t){t=JSON.parse(JSON.stringify(t));for(var a=0;a<t.length;a++)for(var e=0;e<this.tagList.length;e++)t[a]==this.tagList[e].tagId&&(t[a]={tagId:this.tagList[e].tagId,tagName:this.tagList[e].tagName,tagParent:this.tagList[e].tagParent});for(var i=0;i<t.length;i++)"string"==typeof t[i]&&(this.tagName=t[i],this.addTag());this.tags=t},addTag:function(){var t=this;this.$http.put("/share/admin/addTag",{tagName:this.tagName,tagParent:this.tagParent}).then((function(a){200==a.code&&(a=a.data,t.tags[t.tags.length-1]={tagId:a.tagId,tagName:a.tagName,tagParent:a.tagParent}),400==a.code&&t.$message.error(a.message)}))},articleAdd:function(){var t=this,a=this.addForm,e=a.artTitle,i=a.artSummary,n=JSON.parse(JSON.stringify(this.tags));"undefined"==typeof e?this.$message({message:"请输入文章标题",type:"warning"}):"undefined"==typeof i?this.$message({message:"请输入文章摘要",type:"warning"}):0==n.length?this.$message({message:"请选择至少一个标签",type:"warning"}):this.$http.put("/share/admin/add",{article:{artTitle:e,artSummary:i,artContent:this.html},tags:n}).then((function(a){console.log(a),200==a.code&&(t.dialogAddVisible=!1,t.editor=!1,t.$message({message:"发布文章成功",type:"success"}),t.getData())}))},articleEditor:function(){var t=this,a=this.updateForm,e=a.artTitle,i=a.artSummary;this.$http.post("/share/admin/update",{artTitle:e,artSummary:i,artContent:this.html,artNo:this.artNo}).then((function(a){200==a.code&&(t.dialogChangeVisible=!1,t.editor=!1,t.$message({message:"修改文章成功",type:"success"}),t.getData())}))},handleSizeChange:function(t){this.query.pageSize=t,this.query.pageIndex=0,this.getData()},handleCurrentChange:function(t){this.query.pageIndex=t,this.getData()}}}),o=l,r=(e("ce94"),e("2877")),d=Object(r["a"])(o,i,n,!1,null,"f4711f06",null);a["default"]=d.exports}}]);